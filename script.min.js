function SwitchImagePreview(e,t){if(!DragActive&&PreviewImage.children[e]){for(const t of PreviewImage.children)t.style.opacity=t.attributes.id.value==e?1:0;ViewName.innerText=t,ActiveImageId=e}}function SwitchImagePreviewFromCursorPosition(){var e=document.elementFromPoint(CursorPosX,CursorPosY);SwitchImagePreview(e.attributes.id.value,e.attributes.name.value)}function UpdateImagePosition(){const e=100;if(!(PreviewImage.children.length<1)){var t=PreviewImage.children[ActiveImageId].getBoundingClientRect();DragOffsetX>window.innerWidth-e&&(DragOffsetX=window.innerWidth-e),DragOffsetX+t.width<e&&(DragOffsetX=-t.width+e),DragOffsetY>window.innerHeight-e&&(DragOffsetY=window.innerHeight-e),DragOffsetY+t.height<e&&(DragOffsetY=-t.height+e),PreviewImage.style.translate=DragOffsetX+"px "+DragOffsetY+"px"}}function DragImage(e,t){DragActive&&(DragOffsetX+=e,DragOffsetY+=t,UpdateImagePosition())}function ZoomImage(e){if(!(PreviewImage.children.length<1)){var t=1;if(e>0){if(ImageScale<=.025)return;t*=.9}else t=1.1;ImageScale*=t;var a=PreviewImage.children[ActiveImageId].getBoundingClientRect(),i=a.width*t-a.width,r=a.height*t-a.height,n=(CursorPosX-DragOffsetX)/a.width,o=(CursorPosY-DragOffsetY)/a.height;DragOffsetX-=i*n,DragOffsetY-=r*o,UpdateImagePosition(),PreviewImage.style.transform="scale("+ImageScale+")"}}function ProcessInput(e,t=!1){var a=document.getElementById("fileSelect");a.innerText="Add more images",a.classList.add("addMore");for(let a=0;a<e.length;a++){var i=new FileReader;i.onload=function(i){CreateImage(t?`Clipboard ${TotalImageCount}`:e[a].name,TotalImageCount,i.target.result),TotalImageCount++},i.readAsDataURL(e[a])}}function checkImage(e){const t=[".png",".jpg",".jpeg",".webp",".avif",".gif",".heif",".heic",".tiff",".bmp"];var a=e.split("?")[0];for(let e=0;e<t.length;e++)if(a.endsWith(t[e]))return!0;return!1}function ProcessInputURL(e){checkImage(e)&&(CreateImage(e.split("?")[0].split("/").at(-1),TotalImageCount,e),TotalImageCount++)}function CreateImage(e,t,a){var i=document.createElement("div");i.setAttribute("id",t),i.setAttribute("name",e),IMGs.appendChild(i);var r=document.createElement("img");r.setAttribute("id",t),r.setAttribute("src",a),PreviewImage.appendChild(r),i.addEventListener("mouseover",e=>{SwitchImagePreview(i.attributes.id.value,i.attributes.name.value)})}var IMGs=document.getElementById("IMGs"),PreviewImage=document.getElementById("image"),ViewName=document.getElementById("viewName"),DragActive=!1,DragOffsetX=0,DragOffsetY=0,ImageScale=1,CursorPosX=0,CursorPosY=0,ActiveImageId=0,TotalImageCount=0,input=document.createElement("input");input.type="file",input.multiple=!0,input.onchange=(e=>ProcessInput(e.target.files)),window.addEventListener("paste",e=>ProcessInput(e.clipboardData.files,!0)),window.addEventListener("drop",e=>{e.preventDefault();var t=e.dataTransfer.getData("text");""!=t&&ProcessInputURL(t),ProcessInput(e.dataTransfer.files),SwitchImagePreviewFromCursorPosition()}),document.addEventListener("dragover",function(e){e.preventDefault()}),document.getElementById("fileSelect").addEventListener("click",e=>{input.click()}),IMGs.addEventListener("mousedown",e=>{e.preventDefault(),DragActive=!0}),IMGs.addEventListener("mouseup",e=>{e.preventDefault(),DragActive=!1,SwitchImagePreviewFromCursorPosition()}),IMGs.addEventListener("mousemove",e=>{e.preventDefault(),DragImage(e.movementX,e.movementY)}),IMGs.addEventListener("wheel",e=>{e.preventDefault(),ZoomImage(e.deltaY)}),document.addEventListener("mousemove",e=>{e.preventDefault(),CursorPosX=e.clientX,CursorPosY=e.clientY});